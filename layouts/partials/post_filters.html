<!-- 分类导航栏 -->
<div class="category-nav mb-4">
  <div class="d-flex flex-wrap align-items-center">
    <span class="mr-2 font-weight-bold">{{ i18n "filter_by" | default "Filter by:" }}</span>
    <div class="btn-group" role="group">
      <button type="button" class="btn btn-sm btn-primary filter-btn active" data-filter="all">
        {{ i18n "all" | default "All" }}
      </button>
      {{ range $name, $items := .Site.Taxonomies.categories }}
      <button type="button" class="btn btn-sm btn-outline-primary filter-btn" data-filter="{{ $name }}">
        {{ $name }} <span class="badge badge-light">{{ len $items }}</span>
      </button>
      {{ end }}
    </div>
  </div>
</div>

<!-- 搜索框 -->
<div class="post-search mb-4">
  <div class="input-group">
    <input type="text" class="form-control" id="post-search-input" placeholder="{{ i18n "search_posts" | default "Search posts..." }}">
    <div class="input-group-append">
      <button class="btn btn-outline-secondary" type="button" id="post-search-button">
        <i class="fas fa-search"></i>
      </button>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // 分类筛选功能
  const filterButtons = document.querySelectorAll('.filter-btn');
  const postItems = document.querySelectorAll('.post-item');
  
  filterButtons.forEach(button => {
    button.addEventListener('click', function() {
      const filter = this.getAttribute('data-filter');
      
      // 更新按钮状态
      filterButtons.forEach(btn => btn.classList.remove('active'));
      this.classList.add('active');
      
      // 筛选文章
      postItems.forEach(item => {
        if (filter === 'all') {
          item.style.display = '';  // 使用空字符串而不是'block'，保持原始display属性
        } else {
          const categories = item.getAttribute('data-categories').split(',');
          if (categories.includes(filter)) {
            item.style.display = '';  // 使用空字符串而不是'block'
          } else {
            item.style.display = 'none';
          }
        }
      });
    });
  });
  
  // 搜索功能
  const searchInput = document.getElementById('post-search-input');
  const searchButton = document.getElementById('post-search-button');
  
  function performSearch() {
    const searchTerm = searchInput.value.toLowerCase();
    
    postItems.forEach(item => {
      const title = item.querySelector('.post-title').textContent.toLowerCase();
      const summary = item.querySelector('.post-summary')?.textContent.toLowerCase() || '';
      
      if (title.includes(searchTerm) || summary.includes(searchTerm)) {
        item.style.display = '';  // 使用空字符串而不是'block'，保持原始display属性
      } else {
        item.style.display = 'none';
      }
    });
  }
  
  searchButton.addEventListener('click', performSearch);
  searchInput.addEventListener('keyup', function(event) {
    if (event.key === 'Enter') {
      performSearch();
    }
  });
});
</script>